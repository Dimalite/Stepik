1.Задание:
Занесите новую строку в таблицу book
Решение:
INSERT INTO book (book_id, title, author, price, amount)
VALUES(1, 'Мастер и Маргарита', 'Булгаков М.А.', 670.99, 3)

2.Задание:
Вывести информацию о всех книгах, хранящихся на складе.
Решение:
SELECT * FROM book

3.Задание:
Выбрать авторов, название книг и их цену из таблицы book.
Решение:
SELECT author,title , price FROM book

4.Задание:
Выбрать названия книг и авторов из таблицы book, для поля title задать имя(псевдоним) Название, для поля author –  Автор.
Решение:
SELECT title AS 'Название',author AS 'Автор' FROM book

5.Задание:
Для упаковки каждой книги требуется 1 лист бумаги, цена которого 1 рубль 65 копеек. Посчитать стоимость упаковки для каждой книги (сколько денег потребуется, чтобы упаковать все экземпляры книги). В запросе вывести название книги, ее количество и стоимость упаковки, последний столбец назвать pack.
Решение:
SELECT title,amount,  1.65 * amount AS pack FROM book

6.Задание:
В конце года цену всех книг на складе пересчитывают – снижают ее на 30%. Написать SQL запрос, который из таблицы book выбирает названия, авторов, количества и вычисляет новые цены книг. Столбец с новой ценой назвать new_price, цену округлить до 2-х знаков после запятой.
Решение:
SELECT title, author, amount, round ((price * 0.7), 2) as new_price
FROM book;

7.Задание:
При анализе продаж книг выяснилось, что наибольшей популярностью пользуются книги Михаила Булгакова, на втором месте книги Сергея Есенина. Исходя из этого решили поднять цену книг Булгакова на 10%, а цену книг Есенина - на 5%. Написать запрос, куда включить автора, название книги и новую цену, последний столбец назвать new_price. Значение округлить до двух знаков после запятой.
Решение:
SELECT author, title, 
round(IF(author="Булгаков М.А.", price * 1.1, IF(author="Есенин С.А.", price * 1.05, price)),2) AS new_price                                         
FROM book

8.Задание:
Для каждого автора вычислить суммарную стоимость книг S (имя столбца Стоимость), а также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца НДС ) , который включен в стоимость и составляет k = 18%,  а также стоимость книг  (Стоимость_без_НДС) без него. Значения округлить до двух знаков после запятой. В запросе для расчета НДС(tax)  и Стоимости без НДС(S_without_tax) использовать следующие формулы:
Решение:
SELECT author, SUM(price * amount) AS Стоимость,
round (SUM(price * amount) / 1.18 * 0.18 ,2)   AS НДС ,
round(SUM(price * amount)/ 1.18 ,2)     AS Стоимость_без_НДС
FROM book
GROUP BY author;

9.Задание:
Вывести  цену самой дешевой книги, цену самой дорогой и среднюю цену книг на складе. Названия столбцов Минимальная_цена, Максимальная_цена, Средняя_цена соответственно. Среднюю цену округлить до двух знаков после запятой.
Решение:
SELECT
ROUND(MIN(price),2) AS Минимальная_цена,
ROUND(MAX(price),2) AS Максимальная_цена,
ROUND(AVG(price),2) AS Средняя_цена
FROM book

10.Задание:
Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». В результат включить только тех авторов, у которых суммарная стоимость книг более 5000 руб. Результат отсортировать по убыванию стоимости.
Решение:
SELECT author, ROUND(SUM(price * amount), 2) AS Стоимость
FROM book
WHERE title <>"Идиот"AND title <> "Белая гвардия"
GROUP BY author
HAVING SUM(price * amount) > 5000
ORDER BY Стоимость DESC

11.Задание:
Вычислить среднюю цену и суммарную стоимость тех книг, количество экземпляров которых принадлежит интервалу от 5 до 14, включительно. Столбцы переименовать как показано в образце, значения округлить до 2-х знаков после запятой.
Решение:
SELECT
ROUND(AVG(price),2) AS Средняя_цена,
ROUND (SUM(price * amount),2) Стоимость
FROM book
WHERE amount BETWEEN 5 AND 14

12.Задание:
Придумайте один или несколько запросов к нашей таблице book, используя групповые функции. Проверьте, правильно ли они работают.
Решение:
SELECT author,
       MIN(price) AS Минимальная_цена,
       MAX(price) AS Максимальная_цена
FROM book
WHERE author <>'Есенин С.А.'
GROUP BY author
HAVING SUM(amount)>5